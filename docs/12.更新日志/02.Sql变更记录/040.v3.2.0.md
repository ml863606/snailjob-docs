---
title: v3.2.0
date: 2024-04-07 09:53:53
permalink: /pages/08f137/
---

<code-group>
  <code-block title="Mysql&MariaDB数据库" active>

```sql
alter table group_config
    add token varchar(64) default 'ER_cKqBTPzCsWA3VyuCfFoccmuIEGXjr5KT' not null comment 'token' ;

alter table job_summary
    change job_id business_id bigint not null comment '业务id (job_id或workflow_id)';

alter table job_summary
    add system_task_type tinyint default 3 not null comment '任务类型 3、JOB任务 4、WORKFLOW任务';

create index idx_namespace_id_group_name_business_id
    on job_summary (namespace_id, group_name, business_id);

drop index idx_namespace_id_group_name_job_id on job_summary;

alter table job_summary
    drop key uk_job_id_trigger_at;

alter table job_summary
    add constraint uk_trigger_at_system_task_type_business_id
        unique (trigger_at, system_task_type, business_id);

create index idx_trigger_at
    on retry_summary (trigger_at);

alter table retry_task_log
    add update_dt datetime default CURRENT_TIMESTAMP not null on update CURRENT_TIMESTAMP comment '修改时间';

alter table retry_task_log_message
    modify message longtext not null comment '异常信息';

alter table retry_task_log_message
    add log_num int default 1 not null comment '日志数量' after message;

alter table retry_task_log_message
    add real_time bigint(13) default 0 not null comment '上报时间' after log_num;


```

  </code-block>

  <code-block title="Postgres数据库">

```sql
alter table group_config
    add token varchar(64) default 'ER_cKqBTPzCsWA3VyuCfFoccmuIEGXjr5KT';

comment on column group_config.token is 'token';

alter table retry_task_log
    add update_dt timestamp default CURRENT_TIMESTAMP not null;

comment on column retry_task_log.update_dt is '修改时间';

alter table job_summary
    rename column job_id to business_id;

comment on column job_summary.business_id is '业务id (job_id或workflow_id)';

alter table job_summary
    add system_task_type smallint default '3'::smallint not null;

comment on column job_summary.system_task_type is '任务类型 3、JOB任务 4、WORKFLOW任务';

create unique index uk_trigger_at_system_task_type_business_id
    on job_summary (trigger_at, system_task_type, business_id);

alter table retry_task_log_message
    add log_num integer default 1 not null;

comment on column retry_task_log_message.log_num is '日志条数';

alter table retry_task_log_message
    add real_time bigint default 0 not null;

comment on column retry_task_log_message.real_time is '实际时间';

alter table group_config
    alter column description drop not null;

alter table group_config
    alter column description set default '';

drop index uk_job_id_trigger_at;

drop index idx_namespace_id_group_name_job_id;

create index idx_namespace_id_group_name_job_id
    on job_summary (namespace_id, group_name, business_id);

```

  </code-block>

  <code-block title="SqlServer数据库">

```sql
本期新增请移步项目中查下以下路径
doc/sql/easy_retry_sqlserver.sql

```

  </code-block>

  <code-block title="Oracle数据库">

```sql
本期新增请移步项目中查下以下路径
doc/sql/easy_retry_oracle.sql
```

  </code-block>
</code-group>
