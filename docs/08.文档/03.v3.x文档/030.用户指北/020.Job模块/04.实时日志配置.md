---
title: 实时日志配置
date: 2024-01-30 09:24:40
permalink: /pages/v3.x/6a5211/
---

## Logback配置（logback.xml)
```maven
<dependency>
		<groupId>ch.qos.logback</groupId>
    <artifactId>logback-core</artifactId>
</dependency>
<dependency>
		<groupId>ch.qos.logback</groupId>
  	<artifactId>logback-classic</artifactId>
</dependency>
```
```xml
<?xml version="1.0" encoding="utf-8"?>

<configuration scan="false">
    <!-- 彩色日志格式 -->
    <property name="CONSOLE_LOG_PATTERN"
              value="${CONSOLE_LOG_PATTERN:-%clr(%d{yyyy-MM-dd HH:mm:ss.SSS}){faint} %clr(${LOG_LEVEL_PATTERN:-%5p}) %clr(${PID:- }){magenta} %clr(---){faint} %clr([%15.15t]){faint} %clr(%-40.40logger{39} %-4line){cyan} %clr(:){faint} %m%n${LOG_EXCEPTION_CONVERSION_WORD:-%wEx}}"/>
    <!-- 彩色日志依赖的渲染类 -->
    <conversionRule conversionWord="clr"
                    converterClass="org.springframework.boot.logging.logback.ColorConverter"/>
    <conversionRule conversionWord="wEx"
                    converterClass="org.springframework.boot.logging.logback.ExtendedWhitespaceThrowableProxyConverter"/>

    <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
        <!-- encoder 默认配置为PatternLayoutEncoder -->
        <encoder>
            <pattern>${CONSOLE_LOG_PATTERN}</pattern>
        </encoder>
    </appender>

    <!-- EasyRetry appender -->
    <appender name="EasyLogAppender" class="com.aizuda.easy.retry.client.common.appender.EasyRetryLogbackAppender">
    </appender>

    <root level="debug">
        <appender-ref ref="STDOUT" />
        <appender-ref ref="EasyLogAppender"/>
    </root>

</configuration>
```

## Log4j配置（log4j.xml）
```maven
 <dependency>
    <groupId>log4j</groupId>
    <artifactId>log4j</artifactId>
    <version>${log4j.version}</version>
</dependency>
```
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE log4j:configuration SYSTEM "log4j.dtd">

<log4j:configuration>
    <!-- EasyRetryLog4jAppender appender -->
    <appender name="EasyRetryLog4jAppender"
              class="com.aizuda.easy.retry.client.common.appender.EasyRetryLog4jAppender">
    </appender>

    <!-- Console appender -->
    <appender name="Console" class="org.apache.log4j.ConsoleAppender">
        <layout class="org.apache.log4j.PatternLayout">
            <param name="ConversionPattern" value="%d [%t] %-5p [%c] - %m%n"/>
        </layout>
    </appender>

    <root>
        <level value="info"></level>
        <appender-ref ref="Console"/>
        <appender-ref ref="EasyRetryLog4jAppender"/>
    </root>
</log4j:configuration>

```

## Log4j2配置（log4j2.xml）
```maven    
<dependency>
  	<groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-log4j2</artifactId>
</dependency>
```

```xml
<?xml version="1.0" encoding="UTF-8"?>
<Configuration>
    <Properties>
        <Property name="CONSOLE_LOG_PATTERN">
            %clr{%d{yyyy-MM-dd HH:mm:ss.SSS}}{faint} %clr{%5p} %clr{${sys:PID}}{magenta} %clr{---}{faint} %clr{[%15.15t]}{faint} %clr{%-40.40c{1.}}{cyan} %clr{:}{faint} %m%n
        </Property>
    </Properties>

    <Appenders>
        <!-- EasyRetry appender -->
        <EasyRetryLog4j2Appender name="EasyRetryLog4j2Appender" ignoreExceptions="true" />

        <!-- Console appender -->
        <Console name="Console" target="SYSTEM_OUT">
            <PatternLayout pattern="${CONSOLE_LOG_PATTERN}" />
        </Console>
    </Appenders>

    <Loggers>
        <Root level="info">
            <AppenderRef ref="Console" />
            <AppenderRef ref="EasyRetryLog4j2Appender"/>
        </Root>
    </Loggers>
</Configuration>
```
